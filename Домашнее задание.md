# Домашнее задание на тему "Понимание JVM"

## Исходный код:

public class JvmComprehension {

    public static void main(String[] args) {
        int i = 1;                      // 1
        Object o = new Object();        // 2
        Integer ii = 2;                 // 3
        printAll(o, i, ii);             // 4
        System.out.println("finished"); // 7
    }

    private static void printAll(Object o, int i, Integer ii) {
        Integer uselessVar = 700;                   // 5
        System.out.println(o.toString() + i + ii);  // 6
    }
}

## Разбор процессов, происходящих в JVM в процессе работы:

### 0 - предварительные действия
Для загрузки классов JVM обращается к системе загрузчика классов.
Она "ленивая", подгружает классы по мере исполнения программы и состоит из трех загрузчиков:
- загрузчик верхнего уровня Application ClassLoader;
- загрузчик Platform ClassLoader;
- загрузчик нижнего уровня Bootstrap ClassLoader;
Запрос сначала попадает загрузчику верхнего уровня, откуда спускается на нижний уровень. Далее если класс находится на уровне, он загружается, если нет - отправляется выше. В нашем случае класс JvmComprehension будет загружен Application ClassLoader, как пользовательский класс (включая его имя, методы, поля).

---

Далее проходит стадия Linking, на которой код проверяется на валидность и подготавливаются статические поля (при наличии) и выполняется связь между классами (при наличии).
Система загрузчиков классов загружает класс JvmComprehension в область памяти metaspace.

---

При вызове метода main в другой области памяти - stack - выделяется часть памяти - фрейм. 

### Строка 1
В стэке в фрейме метода main создается переменная i = 1 типа int. 
### Строка 2
Создается новый объект Object (как ссылочный объект), размещается в области памяти heap - куча. После этого в стэке в фрейме метода main создается ссылка на его расположение.
### Строка 3
Создается новый объект ii = 2 типа Integer, размещается в куче. После этого в стэке в фрейме метода main создается ссылка на его расположение.
### Строка 4
Для выполнения метода printAll в стэке создается отдельный фрейм. 
В стэке в фрейме метода printAll создаются новые ссылки на расположенные в куче объекты o типа Object, ii типа Integer. Также в стэке создается переменная i типа int.
### Строка 5
В куче размещается созданная переменная uselessVar = 700 типа Integer, ссылка на расположение которой создается в стэке во фрейме метода printAll.
### Строка 6
Для выполнения метода println в стэке создается отдельный фрейм. В нем создаются ссылки на объекты o типа Object и ii типа Integer, а также переменная i типа int.
### Строка 7
По завершению метода printAll его фрейм в стэке удаляется. Также пропадает ссылка на uselessVar = 700 типа Integer, соответственно, он становится недоступным, и будет удален сборщиком мусора. Сборка мусора осуществляется Execution Engine, в непредсказуемый момент времени, который вручную не контролируется. 

---

Для выполнения метода println в стэке создается свой фрейм. В куче создается объект "finished" типа String, ссылка на него создается в фрейме метода в стэке.
